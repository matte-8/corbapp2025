<!doctype html>
<html lang="it">
<head>

  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Video - CORB</title>
  <link rel="manifest" href="manifest.json"><meta name="theme-color" content="#6b0f1a">
  <link rel="apple-touch-icon" href="img/icons/icon-192.png"><meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="stylesheet" href="./style.css?v=22">
</head>
<body>
<header class="topbar"><div class="nav"><a href="./index.html" style="color:#fff">←</a><div class="title">Video</div></div>
<div class="right"><button id="menuBtn" class="iconbtn" aria-label="Menu" title="Menu">
<svg width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round"><path d="M3 6h18M3 12h18M3 18h18"/></svg></button></div></header>
<nav id="drawer"><span id="drawer-close">✕</span><h3>Menu</h3>
<a href="./news.html">📰 News</a><a href="./squadra.html">👥 Squadra</a><a href="./video.html">🎥 Video</a>
<a href="./prossima.html">📅 Prossima partita</a><a href="./partite.html">🏆 Risultati</a><a href="./calendario.html">📆 Calendario</a><a href="./admin.html">⚙️ Admin</a></nav>
<script>(function(){const d=document,dr=d.getElementById('drawer'),b=d.getElementById('menuBtn'),x=d.getElementById('drawer-close');b&&b.addEventListener('click',e=>{e.stopPropagation();dr.classList.add('open')});x&&x.addEventListener('click',()=>dr.classList.remove('open'));d.addEventListener('click',e=>{if(dr.classList.contains('open')&&!dr.contains(e.target)&&e.target!==b)dr.classList.remove('open')});})();</script>
  
<main class="container">
  <section class="card">
    <h2 style="margin:0 0 12px 0">Ultimi video</h2>
    <div id="videoGrid" class="video-grid"></div>
  </section>
</main>

<script type="module">
  import { get } from './data-store.js';
  function sanitizeUrl(u){ if(!u) return '#'; try{ return new URL(u, location.href).toString(); }catch{return u;} }
  function card(v){
    const title = v.nome || 'Video';
    const thumb = v.logo || 'https://placehold.co/800x450?text=Video';
    const link  = sanitizeUrl(v.link || '#');
    const host  = (()=>{ try{ return new URL(link).hostname.replace('www.',''); }catch{return ''} })();
    return `<a class="video-card" href="${link}" target="_blank" rel="noopener">
      <div class="thumb"><img src="${thumb}" alt="${title}">
        <span class="play"><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2" stroke-linejoin="round"><polygon points="9.5,7.5 18,12 9.5,16.5"/></svg></span></div>
      <div class="caption"><div>${title}</div><div class="small">${host}</div></div></a>`;
  }
  const rows = get('video') || [];
  const grid = document.getElementById('videoGrid');
  grid.innerHTML = rows.length ? rows.map(card).join('') : '<div class="small">Nessun video disponibile</div>';
  if ('serviceWorker' in navigator) navigator.serviceWorker.register('./sw.js');
</script>
</body></html>
