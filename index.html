<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Home - CORB</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#6b0f1a">
  <link rel="apple-touch-icon" href="img/icons/icon-192.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="stylesheet" href="./style.css?v=24">
</head>
<body>
  <!-- Topbar -->
  <header class="topbar">
    <div class="nav">
      <img src="img/logo_c5.png" alt="logo" style="width:28px;height:28px;border-radius:6px;object-fit:cover">
      <div class="title" style="font-weight:700;margin-left:8px">Home</div>
    </div>
    <div class="right">
      <button id="menuBtn" class="iconbtn" aria-label="Menu" title="Menu">
        <svg width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round">
          <path d="M3 6h18M3 12h18M3 18h18"/>
        </svg>
      </button>
    </div>
  </header>

  <!-- Drawer -->
  <nav id="drawer">
    <span id="drawer-close">✕</span>
    <h3>Menu</h3>
    <a href="./news.html">📰 News</a>
    <a href="./squadra.html">👥 Squadra</a>
    <a href="./video.html">🎥 Video</a>
    <a href="./prossima.html">📅 Prossima partita</a>
    <a href="./partite.html">🏆 Risultati</a>
    <a href="./calendario.html">📆 Calendario</a>
    <a href="./admin.html">⚙️ Admin</a>
  </nav>
  <script>
    (function(){
      const d=document,dr=d.getElementById('drawer'),b=d.getElementById('menuBtn'),x=d.getElementById('drawer-close');
      b&&b.addEventListener('click',e=>{e.stopPropagation();dr.classList.add('open')});
      x&&x.addEventListener('click',()=>dr.classList.remove('open'));
      d.addEventListener('click',e=>{
        if(dr.classList.contains('open')&&!dr.contains(e.target)&&e.target!==b) dr.classList.remove('open');
      });
    })();
  </script>

  <main class="container">
    <!-- Griglia tile -->
    <section class="grid-2">
      <a class="card" href="./news.html"      style="background:var(--granata);color:#fff;text-align:center;padding:26px"><div style="font-size:40px">📰</div><div style="font-weight:800;margin-top:6px">News</div></a>
      <a class="card" href="./squadra.html"   style="background:var(--granata);color:#fff;text-align:center;padding:26px"><div style="font-size:40px">👥</div><div style="font-weight:800;margin-top:6px">Squadra</div></a>
      <a class="card" href="./video.html"     style="background:var(--granata);color:#fff;text-align:center;padding:26px"><div style="font-size:40px">🎥</div><div style="font-weight:800;margin-top:6px">Video</div></a>
      <a class="card" href="./prossima.html"  style="background:var(--granata);color:#fff;text-align:center;padding:26px"><div style="font-size:40px">📅</div><div style="font-weight:800;margin-top:6px">Prossima Partita</div></a>
      <a class="card" href="./partite.html"   style="background:var(--granata);color:#fff;text-align:center;padding:26px"><div style="font-size:40px">🏆</div><div style="font-weight:800;margin-top:6px">Risultati</div></a>
      <a class="card" href="./calendario.html"style="background:var(--granata);color:#fff;text-align:center;padding:26px"><div style="font-size:40px">📆</div><div style="font-weight:800;margin-top:6px">Calendario</div></a>
    </section>

    <!-- Ultime News (2 anteprime) -->
    <section class="card">
      <div class="row" style="justify-content:space-between;align-items:center">
        <h2 style="margin:0">Ultime News</h2>
        <a class="small" href="./news.html">Vedi tutte →</a>
      </div>
      <div id="homeNews" style="margin-top:8px"></div>
    </section>

    <!-- Social -->
    <section class="card">
      <h2 style="margin:0 0 8px 0">Seguici sui social</h2>
      <div class="row">
        <a class="pill" href="https://instagram.com" target="_blank" rel="noopener">📷 Instagram</a>
        <a class="pill" href="https://facebook.com" target="_blank" rel="noopener">📘 Facebook</a>
        <a class="pill" href="https://u-s-corbiolo.example" target="_blank" rel="noopener">🌐 Sito</a>
      </div>
    </section>

    <section class="card small" id="lastUpd">Ultimo aggiornamento dati: –</section>
  </main>

  <script type="module">
    import {get, getTimestamp} from './data-store.js';

    // 2 anteprime news
    const list = document.getElementById('homeNews');
    const rows = (get('news')||[]).slice(0,2);
    list.innerHTML = rows.map(n=>`
      <div class="player" style="align-items:flex-start">
        <div style="flex:1">
          <div style="font-weight:700;margin-bottom:2px">${n.titolo||'—'}</div>
          <div class="small">${(n.contenuto||'').slice(0,100)}${(n.contenuto||'').length>100?'…':''}</div>
        </div>
        <a class="pill" href="./news.html">News</a>
      </div>
    `).join('') || '<div class="small">Nessuna news</div>';

    // timestamp
    const ts = getTimestamp();
    document.getElementById('lastUpd').textContent = 'Ultimo aggiornamento dati: ' + (ts ? new Date(ts).toLocaleString() : '—');

    if ('serviceWorker' in navigator) navigator.serviceWorker.register('./sw.js');
  </script>
</body>
</html>
