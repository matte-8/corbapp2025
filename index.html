<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Home - CORB</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#6b0f1a">
  <link rel="apple-touch-icon" href="img/icons/icon-192.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="stylesheet" href="./style.css?v=23">
</head>
<body>
  <!-- Topbar -->
  <header class="topbar">
    <div class="nav">
      <img src="img/logo_c5.png" alt="logo" style="width:28px;height:28px;border-radius:6px;object-fit:cover">
      <div class="title">Home</div>
    </div>
    <div class="right">
      <button id="menuBtn" class="iconbtn" aria-label="Menu" title="Menu">
        <svg width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round">
          <path d="M3 6h18M3 12h18M3 18h18"/>
        </svg>
      </button>
    </div>
  </header>

  <!-- Drawer -->
  <nav id="drawer">
    <span id="drawer-close">✕</span>
    <h3>Menu</h3>
    <a href="./news.html">📰 News</a>
    <a href="./squadra.html">👥 Squadra</a>
    <a href="./video.html">🎥 Video</a>
    <a href="./prossima.html">📅 Prossima partita</a>
    <a href="./partite.html">🏆 Risultati</a>
    <a href="./calendario.html">📆 Calendario</a>
    <a href="./admin.html">⚙️ Admin</a>
  </nav>
  <script>
    (function(){
      const d=document,dr=d.getElementById('drawer'),b=d.getElementById('menuBtn'),x=d.getElementById('drawer-close');
      b&&b.addEventListener('click',e=>{e.stopPropagation();dr.classList.add('open')});
      x&&x.addEventListener('click',()=>dr.classList.remove('open'));
      d.addEventListener('click',e=>{
        if(dr.classList.contains('open')&&!dr.contains(e.target)&&e.target!==b) dr.classList.remove('open');
      });
    })();
  </script>

  <main class="container">
    <!-- Tiles -->
    <section class="tiles">
      <a class="tile" href="./news.html"><span class="emoji">📰</span>News</a>
      <a class="tile" href="./squadra.html"><span class="emoji">👥</span>Squadra</a>
      <a class="tile" href="./video.html"><span class="emoji">🎥</span>Video</a>
      <a class="tile" href="./prossima.html"><span class="emoji">📅</span>Prossima Partita</a>
      <a class="tile" href="./partite.html"><span class="emoji">🏆</span>Risultati</a>
      <a class="tile" href="./calendario.html"><span class="emoji">📆</span>Calendario</a>
    </section>

    <!-- Ultime News -->
    <section class="card">
      <div class="row" style="justify-content:space-between;align-items:center">
        <h2 style="margin:0">Ultime News</h2>
        <a class="small" href="./news.html">Vedi tutte →</a>
      </div>
      <div id="homeNews" style="margin-top:8px"></div>
    </section>

    <!-- Social -->
    <section class="card">
      <h2 style="margin:0 0 8px 0">Seguici sui social</h2>
      <div class="row">
        <a class="pill" href="https://instagram.com" target="_blank" rel="noopener">📷 Instagram</a>
        <a class="pill" href="https://facebook.com" target="_blank" rel="noopener">📘 Facebook</a>
        <a class="pill" href="https://u-s-corbiolo.example" target="_blank" rel="noopener">🌐 Sito</a>
      </div>
    </section>

    <section class="card small" id="lastUpd">Ultimo aggiornamento dati: –</section>
  </main>

  <script type="module">
    import {get,lastUpdated} from './data-store.js';

    const list = document.getElementById('homeNews');
    const rows = (get('news')||[]).slice(0,2); // prendi solo 2 notizie
    list.innerHTML = rows.map(n=>`
      <div class="news-item">
        <div style="font-weight:700;margin-bottom:2px">${n.titolo||'—'}</div>
        <div class="small">${(n.contenuto||'').slice(0,90)}${(n.contenuto||'').length>90?'…':''}</div>
      </div>
    `).join('') || '<div class="small">Nessuna news</div>';

    const u = lastUpdated();
    document.getElementById('lastUpd').textContent =
      'Ultimo aggiornamento dati: ' + (u?new Date(u).toLocaleString(): '—');

    if ('serviceWorker' in navigator) navigator.serviceWorker.register('./sw.js');
  </script>
</body>
</html>
