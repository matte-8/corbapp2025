<!doctype html>
<html lang="it">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Home - CORB</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#6b0f1a">
  <link rel="apple-touch-icon" href="img/icons/icon-192.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <link rel="stylesheet" href="./style.css">
  <style>
    /* Sfondo granata soft sotto a tutto */
    .soft-bg{
      position:fixed; inset:0; z-index:0;
      background:linear-gradient(180deg,#efe1e5 0%, #f3e8eb 40%, #f7f5f6 85%, #ffffff 100%);
    }

    /* Griglia box */
    .grid-home{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;position:relative;z-index:1}
    @media(min-width:720px){.grid-home{grid-template-columns:repeat(3,1fr)}}
    .home-box{
      display:flex;flex-direction:column;justify-content:center;align-items:center;
      background:var(--granata);color:#fff;border-radius:18px;padding:14px;cursor:pointer;
      font-weight:600;text-align:center;min-height:110px;box-shadow:0 6px 20px rgba(0,0,0,.15)
    }
    .home-emoji{font-size:28px;margin-bottom:8px;line-height:1}

    /* Pannelli granata (ultima partita + news) */
    .panel-granata{
      background:var(--granata); color:#fff; border-radius:18px; padding:16px;
      box-shadow:0 10px 30px rgba(0,0,0,.12); position:relative; z-index:1;
    }
    .panel-granata .pill{background:#ffffff22;border-color:#ffffff55;color:#fff}

    /* Ultima partita */
    .last-grid{display:grid;grid-template-columns:1fr auto 1fr;gap:12px;align-items:center}
    .score-big{display:flex;align-items:center;justify-content:center;width:72px;height:72px;
      border-radius:14px;background:#ffffff22;font-weight:800;font-size:24px;color:#fff}

    /* News preview dentro pannello granata */
    .news-mini .item{display:grid;grid-template-columns:1fr auto;gap:6px;padding:12px 0;border-bottom:1px solid #ffffff22}
    .news-mini .item:last-child{border-bottom:0}
    .ellipsis{display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}

    /* Drawer (menu a tendina) */
    #drawer{position:fixed;top:0;right:-260px;width:240px;height:100%;background:#fff;
      box-shadow:-3px 0 12px rgba(0,0,0,.2);transition:.3s;padding:20px;z-index:50}
    #drawer.open{right:0}
    #drawer a{display:block;padding:12px 0;border-bottom:1px solid var(--ring);color:var(--text)}
    #drawer-close{position:absolute;top:12px;right:12px;font-size:20px;cursor:pointer}
  </style>
</head>
<body>
  <!-- Sfondo morbido -->
  <div class="soft-bg"></div>

  <!-- Topbar -->
  <header class="topbar">
    <div class="nav">
      <a href="./index.html" style="color:#fff">â†</a>
      <div class="title" style="font-weight:700;margin-left:8px">Risultati</div>
    </div>
    <div class="right">
      <!-- hamburger SOLO tre linee -->
      <button id="menuBtn" class="iconbtn" aria-label="Menu" title="Menu"
        style="all:unset;display:inline-flex;align-items:center;justify-content:center;cursor:pointer">
        <svg width="26" height="26" viewBox="0 0 24 24" fill="none"
             stroke="#ffffff" stroke-width="2" stroke-linecap="round">
          <path d="M3 6h18M3 12h18M3 18h18"/>
        </svg>
      </button>
    </div>
  </header>

  <!-- Drawer -->
  <nav id="drawer" style="position:fixed;top:0;right:-260px;width:240px;height:100%;background:#fff;box-shadow:-3px 0 12px rgba(0,0,0,.2);transition:.3s;padding:20px;z-index:50">
    <span id="drawer-close" style="position:absolute;top:12px;right:12px;font-size:20px;cursor:pointer">âœ•</span>
    <h3>Menu</h3>
    <a href="./news.html" style="display:block;padding:12px 0;border-bottom:1px solid var(--ring);color:var(--text)">ğŸ“° News</a>
    <a href="./squadra.html" style="display:block;padding:12px 0;border-bottom:1px solid var(--ring);color:var(--text)">ğŸ‘¥ Squadra</a>
    <a href="./sponsor.html" style="display:block;padding:12px 0;border-bottom:1px solid var(--ring);color:var(--text)">ğŸ’° Sponsor</a>
    <a href="./prossima.html" style="display:block;padding:12px 0;border-bottom:1px solid var(--ring);color:var(--text)">ğŸ“… Prossima partita</a>
    <a href="./partite.html" style="display:block;padding:12px 0;border-bottom:1px solid var(--ring);color:var(--text)">ğŸ† Risultati</a>
    <a href="./calendario.html" style="display:block;padding:12px 0;border-bottom:1px solid var(--ring);color:var(--text)">ğŸ“† Calendario</a>
    <a href="./admin.html" style="display:block;padding:12px 0;border-bottom:1px solid var(--ring);color:var(--text)">âš™ï¸ Admin</a>
  </nav>

  <main class="container" style="position:relative;z-index:1">
    <!-- 6 box -->
    <section class="grid-home">
      <a class="home-box" href="./news.html">
        <span class="home-emoji">ğŸ“°</span><div>News</div>
      </a>
      <a class="home-box" href="./squadra.html">
        <span class="home-emoji">ğŸ‘¥</span><div>Squadra</div>
      </a>
      <a class="home-box" href="./sponsor.html">
        <span class="home-emoji">ğŸ¥</span><div>Video</div>
      </a>
      <a class="home-box" href="./prossima.html">
        <span class="home-emoji">ğŸ“…</span><div>Prossima Partita</div>
      </a>
      <a class="home-box" href="./partite.html">
        <span class="home-emoji">ğŸ†</span><div>Risultati</div>
      </a>
      <a class="home-box" href="./calendario.html">
        <span class="home-emoji">ğŸ“†</span><div>Calendario</div>
      </a>
    </section>

    <!-- Ultima partita (pannello granata) -->
    <section class="panel-granata" style="margin-top:14px">
      <div class="row" style="justify-content:space-between">
        <h2 style="margin:0">Ultima partita</h2>
        <a class="pill" href="./partite.html" style="text-decoration:none">Vedi risultati</a>
      </div>
      <div id="lastMatch" class="last-grid" style="margin-top:8px"></div>
    </section>

    <!-- Anteprima ultime 2 news (pannello granata) -->
    <section class="panel-granata" style="margin-top:14px">
      <div class="row" style="justify-content:space-between">
        <h2 style="margin:0">Ultime News</h2>
        <a class="pill" href="./news.html" style="text-decoration:none">Vedi tutte</a>
      </div>
      <div id="newsPreview" class="news-mini"></div>
    </section>

    <!-- Ultimo sync -->
    <section class="card small" style="margin-top:14px;position:relative;z-index:1">
      Ultimo aggiornamento dati: <span id="ls">never</span>
    </section>
  </main>

  <script type="module">
    import {last, get} from './data-store.js';

    // Drawer
    const drawer = document.getElementById('drawer');
    document.getElementById('menuBtn').onclick = () => drawer.classList.add('open');
    document.getElementById('drawer-close').onclick = () => drawer.classList.remove('open');

    // Ultimo sync
    document.getElementById('ls').textContent = last();

    // ===== Ultima partita =====
    const matches = (get('matches') || []).map(m => ({
      ...m,
      date: new Date((m.data||'') + 'T' + (m.ora||'00:00'))
    }));
    const now = new Date();
    // ultima giocata (<= adesso), se non c'Ã¨ prendo la piÃ¹ recente in assoluto
    const lastPlayed = matches
      .filter(m => m.date <= now)
      .sort((a,b) => b.date - a.date)[0] || matches.sort((a,b)=> b.date - a.date)[0];

    const lastBox = document.getElementById('lastMatch');
    if(lastPlayed){
      const home = lastPlayed.casa || 'Corbiolo';
      const away = lastPlayed.fuori || 'Avversario';
      const score = (lastPlayed.risultato || 'â€“').replace('-', ' - ');
      lastBox.innerHTML = `
        <div style="text-align:center">
          <div style="font-weight:700">${home}</div>
          <div class="small" style="opacity:.9">Casa</div>
        </div>
        <div class="score-big">${score}</div>
        <div style="text-align:center">
          <div style="font-weight:700">${away}</div>
          <div class="small" style="opacity:.9">Trasferta</div>
        </div>`;
    } else {
      lastBox.innerHTML = `<div class="small">Nessuna partita disponibile</div>`;
    }

    // ===== Anteprima 2 news =====
    const news = (get('news') || [])
      .map(n => ({titolo:n.titolo||'', contenuto:n.contenuto||'', tag:n.tag||'News'}))
      .slice(-2).reverse();
    const wrap = document.getElementById('newsPreview');
    wrap.innerHTML = news.length
      ? news.map(n => `
          <div class="item">
            <div>
              <div style="font-weight:700">${n.titolo}</div>
              <div class="small ellipsis" style="opacity:.9">${n.contenuto}</div>
            </div>
            <div class="pill">${n.tag}</div>
          </div>`).join('')
      : '<div class="small" style="opacity:.9">Nessuna notizia disponibile</div>';

    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("./sw.js");
    }
  </script>
</body>
</html>
    <div class="nav">
      <img src="img/icons/icon-192.png" style="width:28px;height:28px;border-radius:6px">
      <div class="title" style="font-weight:700;margin-left:8px">Home</div>
    </div>
    <div class="right">
      <a id="menuBtn" class="iconbtn" title="Menu">â˜°</a>
    </div>
  </header>

  <!-- Drawer menu -->
  <nav id="drawer">
    <span id="drawer-close">âœ•</span>
    <h3>Menu</h3>
    <a href="./news.html">ğŸ“° News</a>
    <a href="./squadra.html">ğŸ‘¥ Squadra</a>
    <a href="./sponsor.html">ğŸ’° Sponsor</a>
    <a href="./prossima.html">ğŸ“… Prossima partita</a>
    <a href="./partite.html">ğŸ“Š Risultati</a>
    <a href="./calendario.html">ğŸ“† Calendario</a>
    <a href="./admin.html">âš™ï¸ Admin</a>
  </nav>

  <main class="container">
    <!-- Griglia 6 box -->
    <section class="grid-home">
      <a class="home-box" href="./news.html">
        <span class="home-emoji">ğŸ“°</span><div>News</div>
      </a>
      <a class="home-box" href="./squadra.html">
        <span class="home-emoji">ğŸ‘¥</span><div>Squadra</div>
      </a>
      <a class="home-box" href="./sponsor.html">
        <span class="home-emoji">ğŸ¥</span><div>Video</div>
      </a>
      <a class="home-box" href="./prossima.html">
        <span class="home-emoji">ğŸ“…</span><div>Prossima Partita</div>
      </a>
      <a class="home-box" href="./partite.html">
        <span class="home-emoji">ğŸ†</span><div>Risultati</div>
      </a>
      <a class="home-box" href="./calendario.html">
        <span class="home-emoji">ğŸ“†</span><div>Calendario</div>
      </a>
    </section>

    <!-- Anteprima ultime 2 news -->
    <section class="card news-mini">
      <div class="row" style="justify-content:space-between">
        <h2 style="margin:0">Ultime News</h2>
        <a class="small" href="./news.html">Vedi tutte â†’</a>
      </div>
      <div id="newsPreview"></div>
    </section>

    <!-- SEGUICI SUI SOCIAL -->
<section class="card" style="display:flex;flex-direction:column;gap:12px">
  <h2 style="margin:0">Seguici sui social</h2>
  <div class="social-list">
    <a class="social-btn ig" href="https://instagram.com/tuo_account" target="_blank" rel="noopener">
      <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor"><path d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5zm10 2H7a3 3 0 0 0-3 3v10a3 3 0 0 0 3 3h10a3 3 0 0 0 3-3V7a3 3 0 0 0-3-3zm-5 3.5a5.5 5.5 0 1 1 0 11 5.5 5.5 0 0 1 0-11zm0 2a3.5 3.5 0 1 0 0 7 3.5 3.5 0 0 0 0-7zm5.75-.75a.75.75 0 1 1 0 1.5.75.75 0 0 1 0-1.5z"/></svg>
      <span>Instagram</span>
    </a>
    <a class="social-btn fb" href="https://facebook.com/tuo_account" target="_blank" rel="noopener">
      <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor"><path d="M13 22v-8h3l1-4h-4V7.5c0-1.16.32-1.95 2-1.95H17V2.14C16.61 2.1 15.54 2 14.31 2 11.64 2 10 3.66 10 6.7V10H7v4h3v8h3z"/></svg>
      <span>Facebook</span>
    </a>
    <a class="social-btn web" href="https://tuo-sito.it" target="_blank" rel="noopener">
      <svg viewBox="0 0 24 24" width="20" height="20" fill="currentColor"><path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20zm7.93 9h-3.18a15.9 15.9 0 0 0-1.34-6A8.02 8.02 0 0 1 19.93 11zM12 4c.94 1.28 1.7 3.3 1.97 5H10.03c.27-1.7 1.03-3.72 1.97-5zM6.59 4.99a15.9 15.9 0 0 0-1.34 6H2.07A8.02 8.02 0 0 1 6.59 4.99zM2.07 13h3.18c.14 2.2.7 4.28 1.34 6A8.02 8.02 0 0 1 2.07 13zM12 20c-.94-1.28-1.7-3.3-1.97-5h3.94c-.27 1.7-1.03 3.72-1.97 5zm5.41-1.01c.64-1.72 1.2-3.8 1.34-6h3.18a8.02 8.02 0 0 1-4.52 6z"/></svg>
      <span>Sito ufficiale</span>
    </a>
  </div>
</section>


    <!-- Ultimo sync -->
    <section class="card small">
      Ultimo aggiornamento dati: <span id="ls">never</span>
    </section>
  </main>

  <script type="module">
    import {last, get} from './data-store.js';

    // Drawer
    const drawer = document.getElementById('drawer');
    document.getElementById('menuBtn').onclick = () => drawer.classList.add('open');
    document.getElementById('drawer-close').onclick = () => drawer.classList.remove('open');

    // Ultimo sync
    document.getElementById('ls').textContent = last();

    // Anteprima 2 news dalla cache
    const news = (get('news') || [])
      .map(n => ({titolo:n.titolo||'', contenuto:n.contenuto||'', img:n.img||'', tag:n.tag||''}))
      .slice(-2)        // ultime due in coda
      .reverse();       // mostra prima la piÃ¹ recente

    const wrap = document.getElementById('newsPreview');
    wrap.innerHTML = news.length
      ? news.map(n => `
          <div class="item">
            <div>
              <div style="font-weight:600">${n.titolo}</div>
              <div class="small ellipsis">${n.contenuto}</div>
            </div>
            <div class="pill">${n.tag || 'News'}</div>
          </div>`).join('')
      : '<div class="small">Nessuna notizia disponibile</div>';

    if ("serviceWorker" in navigator) {
      navigator.serviceWorker.register("./sw.js");
    }
  </script>
</body>
</html>
