<!doctype html>
<html lang="it"><head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Admin - CORB</title>
<link rel="manifest" href="manifest.json"><meta name="theme-color" content="#6b0f1a">
<link rel="apple-touch-icon" href="img/icons/icon-192.png"><meta name="apple-mobile-web-app-capable" content="yes">
<link rel="stylesheet" href="./style.css?v=22"></head>
<body>
<header class="topbar"><div class="nav"><a href="./index.html" style="color:#fff">â†</a><div class="title">Admin</div></div>
<div class="right"><button id="menuBtn" class="iconbtn" aria-label="Menu" title="Menu"><svg width="26" height="26" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round"><path d="M3 6h18M3 12h18M3 18h18"/></svg></button></div></header>
<nav id="drawer"><span id="drawer-close">âœ•</span><h3>Menu</h3>
<a href="./news.html">ğŸ“° News</a><a href="./squadra.html">ğŸ‘¥ Squadra</a><a href="./video.html">ğŸ¥ Video</a>
<a href="./prossima.html">ğŸ“… Prossima partita</a><a href="./partite.html">ğŸ† Risultati</a><a href="./calendario.html">ğŸ“† Calendario</a><a href="./admin.html">âš™ï¸ Admin</a></nav>
<script>(function(){const d=document,dr=d.getElementById('drawer'),b=d.getElementById('menuBtn'),x=d.getElementById('drawer-close');b&&b.addEventListener('click',e=>{e.stopPropagation();dr.classList.add('open')});x&&x.addEventListener('click',()=>dr.classList.remove('open'));d.addEventListener('click',e=>{if(dr.classList.contains('open')&&!dr.contains(e.target)&&e.target!==b)dr.classList.remove('open')});})();</script>

<main class="container">
  <section class="card" id="gate">
    <h2 style="margin-top:0">Accesso</h2>
    <input id="pwd" type="password" placeholder="Password" style="padding:10px;border-radius:10px;border:1px solid var(--ring);width:100%;max-width:260px">
    <button id="go" class="pill" style="margin-left:8px">Entra</button>
    <div id="msg" class="small" style="margin-top:8px;color:var(--muted)"></div>
  </section>

  <section class="card" id="panel" style="display:none">
    <h2 style="margin-top:0">Pannello</h2>
    <div class="small">Ultimo aggiornamento: <span id="upd">â€“</span></div>
    <div class="row" style="margin-top:12px">
      <button id="refresh" class="pill">ğŸ”„ Aggiorna dati</button>
    </div>
    <div id="log" class="small" style="margin-top:10px"></div>
  </section>
</main>

<script type="module">
  import {refreshAll,lastUpdated} from './data-store.js';
  const gate=document.getElementById('gate'), panel=document.getElementById('panel'), msg=document.getElementById('msg');
  document.getElementById('go').onclick=()=>{
    const ok = document.getElementById('pwd').value==='corb25';
    if(!ok){ msg.textContent='Password errata'; return; }
    gate.style.display='none'; panel.style.display='block';
    const u=lastUpdated(); document.getElementById('upd').textContent = u? new Date(u).toLocaleString():'â€“';
  };
  document.getElementById('refresh').onclick=async()=>{
    const log=document.getElementById('log'); log.textContent='Aggiornamento in corsoâ€¦';
    try{ await refreshAll(); const u=lastUpdated(); document.getElementById('upd').textContent=new Date(u).toLocaleString(); log.textContent='Fatto âœ…'; }
    catch(e){ log.textContent='Errore: '+(e.message||e); }
  };
  if ('serviceWorker' in navigator) navigator.serviceWorker.register('./sw.js');
</script>
</body></html>
